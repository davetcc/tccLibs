#include "ControlAppOledEncoderPico_menu.h"
#include "PlatformDeterminationWire.h"
#include <PlatformDetermination.h>
#include <TaskManagerIO.h>
#include <hardware/i2c.h>

void setup() {
    // prepare the I2C bus before setting up the menu
    i2c_init(i2c_default, 400 * 1000);
    gpio_set_function(PICO_DEFAULT_I2C_SDA_PIN, GPIO_FUNC_I2C);
    gpio_set_function(PICO_DEFAULT_I2C_SCL_PIN, GPIO_FUNC_I2C);
    gpio_pull_up(PICO_DEFAULT_I2C_SDA_PIN);
    gpio_pull_up(PICO_DEFAULT_I2C_SCL_PIN);
    ioaWireBegin(i2c_default);

    // now prepare logging
    IOLOG_START_SERIAL

    setupMenu();
}

int main() {
    setup();
    while(1) {
        taskManager.rpiSleepingRunLoop();
    }
}
